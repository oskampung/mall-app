(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/goods/goods"],{5920:function(e,t,s){},"81aa":function(e,t,s){"use strict";(function(e){s("1822");o(s("66fd"));var t=o(s("d425"));function o(e){return e&&e.__esModule?e:{default:e}}e(t.default)}).call(this,s("543d")["createPage"])},"8b0e":function(e,t,s){"use strict";s.r(t);var o=s("e048"),i=s.n(o);for(var a in o)"default"!==a&&function(e){s.d(t,e,(function(){return o[e]}))}(a);t["default"]=i.a},aeb7:function(e,t,s){"use strict";var o=s("5920"),i=s.n(o);i.a},d425:function(e,t,s){"use strict";s.r(t);var o=s("daa1"),i=s("8b0e");for(var a in i)"default"!==a&&function(e){s.d(t,e,(function(){return i[e]}))}(a);s("aeb7");var n,r=s("f0c5"),c=Object(r["a"])(i["default"],o["b"],o["c"],!1,null,null,null,!1,o["a"],n);t["default"]=c.exports},daa1:function(e,t,s){"use strict";var o={"uni-icons":function(){return Promise.all([s.e("common/vendor"),s.e("components/uni-icons/uni-icons")]).then(s.bind(null,"c930"))},"uni-fab":function(){return s.e("components/uni-fab/uni-fab").then(s.bind(null,"54c0"))},"uni-popup":function(){return Promise.all([s.e("common/vendor"),s.e("components/uni-popup/uni-popup")]).then(s.bind(null,"38ef"))},"wm-poster":function(){return Promise.all([s.e("common/vendor"),s.e("components/wm-poster/wm-poster")]).then(s.bind(null,"a007"))}},i=function(){var e=this,t=e.$createElement,s=(e._self._c,e.selectArr.join(" ")),o=e.selectArr.join(" ");e.$mp.data=Object.assign({},{$root:{g0:s,g1:o}})},a=[];s.d(t,"b",(function(){return i})),s.d(t,"c",(function(){return a})),s.d(t,"a",(function(){return o}))},e048:function(e,t,s){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=s("4a45"),i=s("f169"),a=s("4be7"),n=s("116b"),r=s("7435");function c(e){return d(e)||h(e)||g(e)||l()}function l(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function h(e){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}function d(e){if(Array.isArray(e))return f(e)}function p(e){if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(e=g(e))){var t=0,s=function(){};return{s:s,n:function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}},e:function(e){throw e},f:s}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,i,a=!0,n=!1;return{s:function(){o=e[Symbol.iterator]()},n:function(){var e=o.next();return a=e.done,e},e:function(e){n=!0,i=e},f:function(){try{a||null==o.return||o.return()}finally{if(n)throw i}}}}function g(e,t){if(e){if("string"===typeof e)return f(e,t);var s=Object.prototype.toString.call(e).slice(8,-1);return"Object"===s&&e.constructor&&(s=e.constructor.name),"Map"===s||"Set"===s?Array.from(s):"Arguments"===s||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s)?f(e,t):void 0}}function f(e,t){(null==t||t>e.length)&&(t=e.length);for(var s=0,o=new Array(t);s<t;s++)o[s]=e[s];return o}var m=function(){s.e("components/uni-fab/uni-fab").then(function(){return resolve(s("54c0"))}.bind(null,s)).catch(s.oe)},v=function(){Promise.all([s.e("common/vendor"),s.e("components/uni-icons/uni-icons")]).then(function(){return resolve(s("c930"))}.bind(null,s)).catch(s.oe)},I=function(){s.e("components/hch-poster/hch-poster").then(function(){return resolve(s("6670"))}.bind(null,s)).catch(s.oe)},y=function(){Promise.all([s.e("common/vendor"),s.e("components/wm-poster/wm-poster")]).then(function(){return resolve(s("a007"))}.bind(null,s)).catch(s.oe)},b=function(){Promise.all([s.e("common/vendor"),s.e("components/uni-popup/uni-popup")]).then(function(){return resolve(s("38ef"))}.bind(null,s)).catch(s.oe)},S={components:{uniFab:m,uniIcons:v,hchPoster:I,wmPoster:y,uniPopup:b},data:function(){return{code:null,ClickLike_Status:!1,scr:"",dz_Name:"赞",src_dz:s("9b03"),dzd_status:!1,src_dzd:s("7f8d"),phoneW:e.getSystemInfoSync().windowWidth,provider:null,userId:null,baseUrl:o.requestURL,footerHeight:"45px",marginTop:"0px",beforeHeaderzIndex:11,afterHeaderzIndex:10,beforeHeaderOpacity:1,afterHeaderOpacity:0,swiperList:[],currentSwiper:0,anchorlist:[],selectAnchor:0,serviceClass:"hide",shareClass:"none",buylist:[],goodsId:"",goodsData:{id:0,name:"",price:"~",number:1,coverImg:"",category:null,likes:88,views:50,service:[{name:"正品保证",description:"此商品官方保证为正品"}],spec:{name:"",specItem:[]},freight:0,freeFreight:0,discount:"",salesNum:0,comment:{number:0,userface:"../../static/img/face.png",username:"爱美丽的大漂亮",content:"很不错，新发现的国朝品牌，很好用，和图片色差不大，值得购买！推荐推荐"}},specs:[],specNames:"",selectSpec:[],isKeep:!1,descriptionStr:"",detailHtml:"",skuSure:!0,product:{},showSet:!1,specClass:"none",specifications:[],difference:[],shopItemInfo:{},selectArr:[],subIndex:[],selectshop:{},selectNum:1,targetFunction:"",horizontal:"right",vertical:"bottom",direction:"vertical",fabShow:!0,pattern:{color:"#7A7E83",backgroundColor:"#FFFFFF",selectedColor:"#007AFF",buttonColor:"#f47952",widh:"45px"},content:[{iconPath:"/static/img/tabBar/shop.png",selectedIconPath:"/static/img/tabBar/shop-on.png",text:"商城",active:!1,path:"/pages/tabBar/home/home"},{iconPath:"/static/img/tabBar/cart.png",selectedIconPath:"/static/img/tabBar/cart-on.png",text:"购物车",active:!1,path:"/pages/tabBar/cart/cart"},{iconPath:"/static/img/tabBar/users.png",selectedIconPath:"/static/img/tabBar/users-on.png",text:"我的",active:!1,path:"/pages/tabBar/user/user"}],deliveryFlag:!1,canvasFlag:!0,posterData:{},shareQrCode:"",shareTitle:"我的态度我的AUU ~好物要分享",shareUserId:null,chatTitle:"AUU产品咨询",avatarListWidth:e.getSystemInfoSync().windowWidth-110,swiperAutoplay:!0,swiperIndex:0,swiperTemp:new Map,couponTplList:[],couponType:{s0:"立减券",s1:"满减券",s2:"指定产品",s3:"本产品同品类可用"},channel:e.getStorageSync("promotionChannels"),avatarUrl:null,nickname:null,avatar:[{headimgUrl:"/static/icon/more.png"}],likesAvatars:[],likeDisplay:!1,likeLable:"点赞次数",salesnum:!1}},computed:{canCount:function(){return this.subIndex.some((function(e){return-1===e}))}},onShareAppMessage:function(t){return null!=t.u&&(this.shareUserId=u,e.setStorageSync("shareUserId",u)),t.from,{title:this.shareTitle,path:"/pages/goods/goods?u="+this.userId+"&gid="+this.goodsId}},onShow:function(){this.userId=e.getStorageSync("userId"),this.avatarUrl=e.getStorageSync("avatarUrl"),this.nickname=e.getStorageSync("nickname")},onLoad:function(t){var s=this;this.shareUserId=e.getStorageSync("shareUserId");var o=this.provider;if(e.getProvider({service:"oauth",success:function(e){o=e.provider[0]}}),this.provider=o,this.goodsId=e.getStorageSync("currentGoodsId"),null!=t.scene)for(var i=decodeURIComponent(t.scene),a=i.split("&"),n=0;n<a.length;n++)a[n].indexOf("u=")>-1&&(this.shareUserId=a[n].replace("u=",""),t["u"]=this.shareUserId),a[n].indexOf("gid=")>-1&&(this.goodsId=a[1].replace("gid=",""),t["gid"]=this.goodsId),a[n].indexOf("ch=")>-1&&(this.channel=a[n].replace("ch=",""),t.ch=this.channel);null!=t.gid&&(this.goodsId=t.gid),null!=t.u&&(this.shareUserId=t.u,e.setStorageSync("shareUserId",this.shareUserId)),null!=t.ch&&(this.channel=t.ch,e.setStorageSync("promotionChannels",this.channel)),e.setStorageSync("currentGoodsId",this.goodsId),this.loadGoodsInfo(),this.userId=e.getStorageSync("userId"),"weixin"!=o&&"toutiao"!=o||(e.login({provider:o,success:function(e){s.code=e.code}}),null!=this.userId&&""!=this.userId||this.oauthLogin(),e.showShareMenu({withShareTicket:!0,success:function(e){},fail:function(e){},complete:function(e){}})),this.showBack=!1,this.loadGoodsSku(),this.specifications.map((function(e){s.selectArr.push(""),s.subIndex.push(-1)})),this.hideService(),this.loadAtapter(),this.loadShowLikeView()},onReady:function(){this.calcAnchor()},onPageScroll:function(e){this.selectAnchor=e.scrollTop>=this.anchorlist[2].top?2:e.scrollTop>=this.anchorlist[1].top?1:0;var t=375;e.scrollTop=e.scrollTop>t?375:e.scrollTop,this.afterHeaderOpacity=e.scrollTop*(1/t),this.beforeHeaderOpacity=1-this.afterHeaderOpacity,this.beforeHeaderzIndex=e.scrollTop>0?10:11,this.afterHeaderzIndex=e.scrollTop>0?11:10,this.$refs.fab.close()},onReachBottom:function(){e.showToast({title:"正在加载..."}),this.fabShow=!0},mounted:function(){},methods:{loadShowLikeView:function(){var e=this;(0,i.getParam)("_LIKE_BTN").then((function(t){if(console.log(t),0==t.data.code&&null!=t.data.data){var s=JSON.parse(t.data.data);console.log(s),e.likeLable=s.lable,e.likeDisplay=s.display,e.salesnum=s.salesnum,e.likeDisplay&&e.loadGoodsFansLikes()}}))},loadCouponTplList:function(){var e=this,t={goodsId:this.goodsId,categoryId:13,status:"0"};(0,r.getCouponTplList)(t).then((function(t){0==t.data.code&&null!=t.data.data&&(e.couponTplList=t.data.data)}))},saveCoupon:function(t){var s={scenes:"1",couponTplId:t};e.showLoading({title:"正在领取优惠券"}),(0,r.sendCoupon)(s).then((function(t){e.hideLoading(),console.log(t),e.showToast({title:0==t.data.code&&t.data.data?"领取成功":t.data.msg,icon:0==t.data.code&&t.data.data?"success":"none",duration:1500})}))},fansLikesOnly:function(){var t=this;this.ClickLike_Status=!0,setTimeout((function(){t.ClickLike_Status=!1,t.src=null==t.avatarUrl?t.src_dzd:t.avatarUrl,t.dzd_status=!0}),2e3),this.goodsData.likes=this.goodsData.likes+1;var s={id:this.goodsId,likes:this.goodsData.likes};(0,n.updatGoods)(s).then((function(t){e.showToast({title:"点赞成功",icon:"none"})})),this.likesAvatars.indexOf(this.avatarUrl)<0&&(this.likesAvatars.shift(),this.likesAvatars.shift(),this.likesAvatars.push(this.avatarUrl))},getWxUserInfo:function(t){console.log(t);var s=t.detail.userInfo,o=s.avatarUrl,i=s.nickName;this.avatarUrl=o,this.nickname=i;var n={userId:this.userId,avatar:o,nickname:i,name:i,encryptedData:t.detail.encryptedData,iv:t.detail.iv,state:getApp().globalData.PROVIDER[this.provider],code:this.code},r=t.target.id;if("likesBtn"==r)this.fansLikesOnly();else if("couponBtn"==r){var c=t.currentTarget.dataset.value;this.saveCoupon(c)}else this.getSysShareQrcode(i,o);var l=e.getStorageSync("avatarUrl");""!=l&&null!=l||(0,a.updateUserInfo)(n).then((function(t){e.setStorageSync("avatarUrl",o),e.setStorageSync("nickname",i)}))},fansLikes:function(t){console.log(t);var s=t.detail.userInfo,o=s.avatarUrl,i=s.nickName,n={userId:this.userId,avatar:o,nickname:i,name:i,encryptedData:t.detail.encryptedData,iv:t.detail.iv,state:getApp().globalData.PROVIDER[this.provider],code:this.code};this.avatar.push({headimgUrl:o}),e.setStorageSync("avatar",o),e.setStorageSync("nickname",i),(0,a.updateUserInfo)(n).then((function(e){console.log(e)}))},loadGoodsFansLikes:function(){var e=this,t={limit:Math.ceil((this.phoneW-120)/20),goodsId:this.goodsId};(0,n.getGoodsFansLikes)(t).then((function(t){if(200==t.statusCode&&null!=t.data.data){e.avatar=e.avatar.concat(t.data.data);for(var s=0;s<e.avatar.length;s++)e.likesAvatars.push(e.avatar[s].headimgUrl)}}))},loadAtapter:function(){var t=this;e.getSystemInfo({success:function(e){var s=e.model;(s.replace(/\s*/g,"").toLocaleLowerCase().indexOf("iphonex")>-1||s.replace(/\s*/g,"").toLocaleLowerCase().indexOf("iphone11")>-1)&&(t.footerHeight="70px",t.marginTop="-10px")}})},checkLoginSession:function(){null==this.userId?(e.removeStorageSync("Authorization"),e.removeStorageSync("userId"),this.oauthLogin()):null!=this.shareUserId&&this.toAddShareIntegral()},loadGoodsInfo:function(){var e=this,t=this.goodsId;(0,n.getGoodsInfo)(t).then((function(t){if(0==t.data.code&&null!=t.data.data){var s=t.data.data;null!=s.shareTitle&&(e.shareTitle=s.shareTitle),e.goodsData.likes=s.likes,e.goodsData.views=s.views,e.goodsData.coverImg=s.coverImgs,e.selectshop.coverImg=e.goodsData.coverImg,e.buylist[0]=s,e.goodsData.salesNum=s.salesNum,e.goodsData.id=s.id,e.goodsData.price=s.price,e.goodsData.category=s.category,e.goodsData.name=s.name,e.goodsData.freeFreight=s.freeFreight,e.goodsData.freight=s.freight,e.goodsData.discount=s.discount,e.goodsData.discountPrice=s.discountPrice,e.goodsData.originalPrice=s.originalPrice,e.chatTitle=s.name+" ~￥"+s.price,e.detailHtml=null==s.detailHtml?"":s.detailHtml;var o=[];if(null!=s.detailImgs){o.push('<p style="text-align: center;">');var i,a=p(s.detailImgs);try{for(a.s();!(i=a.n()).done;){var n=i.value;o.push('<img src="'+n.value+'" style="max-width:100%;">')}}catch(y){a.e(y)}finally{a.f()}o.push("</p>")}e.descriptionStr=o.join(""),e.swiperList=s.imgs;var r={id:e.swiperList.length,label:"",sort:e.swiperList.length,value:e.goodsData.coverImg};if(e.swiperList.push(r),null!=s.ratings&&s.ratings.length>0){var c={number:s.commentNum,userface:s.ratings[0].avatar||e.goodsData.comment.avatar,username:s.ratings[0].userName||e.goodsData.comment.username,content:s.ratings[0].content||e.goodsData.comment.content};e.goodsData.comment=c}else e.goodsData.comment=[];if(e.goodsData.service=s.serverList,null!=s.specCategory&&s.specCategory.length>0)for(var l in s.specCategory){var h,u={name:s.specCategory[l].specName,specItem:[]},d=p(s.specCategory[l].specItems);try{for(d.s();!(h=d.n()).done;){var g=h.value;u.specItem.push(g)}}catch(y){d.e(y)}finally{d.f()}e.specs.push(u),e.selectSpec.push({id:0,name:""})}if(null!=s.specCategory&&s.specCategory.length>0){var f,m={name:s.specCategory[0].specName,specItem:[]},v=p(s.specCategory[0].specItems);try{for(v.s();!(f=v.n()).done;){var I=f.value;m.specItem.push(I.specName)}}catch(y){v.e(y)}finally{v.f()}e.goodsData.spec=m}}})),this.loadCouponTplList()},loadGoodsSku:function(){var e=this;(0,n.getGoodsSkuList)(this.goodsId).then((function(t){if(0==t.data.code){e.specifications=t.data.data.specList,e.difference=t.data.data.skuList;for(var s=0;s<e.difference.length;s++){null!=e.difference[s].imgs&&e.difference[s].imgs.length>0&&(e.difference[s].coverImgs=e.difference[s].imgs[0].value),e.difference[s].difference=[];var o,i=p(e.difference[s].sku);try{for(i.s();!(o=i.n()).done;){var a=o.value;e.difference[s].difference.push(a.name)}}catch(n){i.e(n)}finally{i.f()}}e.checkItem(),e.checkInpath(-1)}}))},joinCart:function(){var t=this,s="";if(this.buylist[0]["specs"]=[],this.buylist[0]["goodsName"]=this.buylist[0].name,this.buylist[0]["number"]=this.selectNum,this.buylist[0]["price"]=this.selectshop.price,this.buylist[0]["skuId"]=this.selectshop.id,this.selectArr.length!=this.specifications.length)return this.targetFunction="cart",this.showSpec((function(){t.toConfirmation()}));var o,i=p(this.selectArr);try{for(i.s();!(o=i.n()).done;){var a=o.value;s=s+" "+a}}catch(l){i.e(l)}finally{i.f()}this.specNames=s,this.buylist[0]["specNames"]=s;var n=this.buylist[0];this.deleteProperties(n);var r=e.getStorageSync("cartGoodsList");console.log(r),r=""==r?[]:r;for(var c=0;c<r.length;c++)if(r[c].id==n.id&&r[c].skuId==n.skuId)return e.showToast({title:"已加入购物车"}),!1;r.push(n),e.setStorage({key:"cartGoodsList",data:r,success:function(){e.showToast({title:"已加入购物车"})}})},buy:function(){var t=this,s="";if(this.buylist[0]["goodsName"]=this.buylist[0].name,this.buylist[0]["specs"]=[],this.buylist[0]["number"]=this.selectNum,this.buylist[0]["price"]=this.selectshop.price,this.buylist[0]["skuId"]=this.selectshop.id,this.selectArr.length!=this.specifications.length)return this.targetFunction="buy",this.showSpec((function(){t.toConfirmation()}));var o,i=p(this.selectArr);try{for(i.s();!(o=i.n()).done;){var a=o.value;s=s+" "+a}}catch(r){i.e(r)}finally{i.f()}this.specNames=s,this.buylist[0]["specNames"]=s;var n=this.buylist[0];this.deleteProperties(n),e.setStorage({key:"buylist",data:[n],success:function(){e.navigateTo({url:"../order/confirmation"})}})},deleteProperties:function(e){delete e.specCategory,delete e.services,delete e.serverList,delete e.ratings,delete e.detailImg,delete e.detailImgs},toConfirmation:function(){var e=[],t={id:this.goodsData.id,img:null!=this.goodsData.coverImgs?this.goodsData.coverImgs:"../../static/img/goods/p1.jpg",name:this.goodsData.name,specNames:"规格:"+this.specNames,price:this.goodsData.price,number:this.goodsData.number};this.buylist[0].img=this.goodsData.coverImgs,this.buylist[0]["number"]=1,this.buylist[0]["goodsPrice"]=this.goodsData.price,e.push(t)},toRatings:function(){if(0==this.goodsData.comment.length)return e.showToast({title:"该商品暂无评论",icon:"none"}),!1;e.navigateTo({url:"/pages/goods/ratings/ratings?gid="+this.goodsId})},skuClick:function(t,s,o,i){if(t.ishow){if(this.selectArr[s]!=t.name?(this.$set(this.selectArr,s,t.name),this.$set(this.subIndex,s,i)):(this.$set(this.selectArr,s,""),this.$set(this.subIndex,s,-1)),this.selectArr.length!=this.specifications.length)return void(this.skuSure=!0);for(var a=0;a<this.selectArr.length;a++)if(""==this.selectArr[a])return void(this.skuSure=!0);if(this.checkInpath(s),this.selectArr.every((function(e){return""!=e}))){if(this.selectshop=this.shopItemInfo[this.selectArr],null==this.selectshop)return e.showToast({title:"没有这个规格组合",icon:"none"}),!1;null!=this.selectshop&&null==this.selectshop.coverImgs&&(this.selectshop.coverImgs=this.goodsData.coverImgs),this.selectNum=1}}this.selectArr.length==this.specifications.length&&(this.skuSure=!1,null!=this.selectshop.imgs&&this.selectshop.imgs.length>0&&(this.swiperAutoplay=!0,this.swiperTemp.has(this.selectshop.id)?this.swiperIndex=this.swiperTemp.get(this.selectshop.id):(this.swiperList=this.swiperList.concat(this.selectshop.imgs),this.swiperIndex=this.swiperList.length-this.selectshop.imgs.length,this.swiperTemp.set(this.selectshop.id,this.swiperIndex)),this.swiperAutoplay=!1))},checkInpath:function(e){for(var t=0,s=this.specifications.length;t<s;t++)if(t!=e)for(var o=this.specifications[t].item.length,i=0;i<o;i++)if(-1==this.subIndex[t]||i!=this.subIndex[t]){var a=c(this.selectArr);this.$set(a,t,this.specifications[t].item[i].name);var n=a.filter((function(e){return""!==e&&"undefined"!==typeof e}));this.shopItemInfo.hasOwnProperty(n)?this.$set(this.specifications[t].item[i],"ishow",!0):this.$set(this.specifications[t].item[i],"ishow",!1)}},checkItem:function(){var e=this;this.difference.reduce((function(t,s){return t.concat(s.difference.reduce((function(t,o){return t.concat(t.map((function(t){return e.shopItemInfo.hasOwnProperty([].concat(c(t),[o]))||(e.shopItemInfo[[].concat(c(t),[o])]=s),[].concat(c(t),[o])})))}),[[]]))}),[[]])},trigger:function(t){this.content[t.index].active=!t.item.active,e.switchTab({url:t.item.path})},showComments:function(e){},setSelectSpec:function(e,t,s){this.selectSpec[e]={name:s,id:t}},sub:function(){this.goodsData.number<=1||(this.selectNum--,this.goodsData.number--)},add:function(){this.selectNum++,this.goodsData.number++},toAnchor:function(t){this.selectAnchor=t,e.pageScrollTo({scrollTop:this.anchorlist[t].top,duration:200})},calcAnchor:function(){var t=this;this.anchorlist=[{name:"主图",top:0},{name:"评价",top:0},{name:"详情",top:0}];var s=e.createSelectorQuery().select("#comments");s.boundingClientRect((function(s){var o=0,i=e.upx2px(100);t.anchorlist[1].top=s.top-i-o,t.anchorlist[2].top=s.bottom-i-o})).exec()},back:function(){e.navigateBack()},showService:function(){this.serviceClass="show"},hideService:function(){var e=this;this.swiperAutoplay=!0,setTimeout((function(){e.serviceClass="none"}),200)},showSpec:function(e){this.specClass="show",this.specCallback=e,this.swiperAutoplay=!1},specCallback:function(){},hideSpec:function(){var e=this;this.swiperAutoplay=!0,this.specClass="hide",this.selectSpec&&this.specCallback&&this.specCallback(),this.specCallback=!1,setTimeout((function(){e.specClass="none"}),200)},discard:function(){},submitSku:function(){this.closeSf()},closeSku:function(){var e=this;this.specClass="hide",this.swiperAutoplay=!0,setTimeout((function(){e.specClass="none"}),250)},closeSf:function(){var e=this;this.specClass="hide",setTimeout((function(){e.specClass="none","buy"==e.targetFunction?e.buy():"cart"==e.targetFunction&&e.joinCart()}),250)},changeNum:function(e){this.selectNum=parseInt(e)},toggleSpec:function(){this.specClass="show",this.swiperAutoplay=!1},swiperChange:function(e){this.currentSwiper=e.detail.current},toMsg:function(){e.navigateTo({url:"../msg/msg"})},toChat:function(){var t={goodsName:this.goodsData.name,goodsImg:this.goodsData.coverImg,goodsId:this.goodsId,price:this.goodsData.price};return e.setStorageSync("msgShowObj",t),e.navigateTo({url:"../msg/chat/index"}),!1},oauthLogin:function(){var t=this.provider,s=this;e.login({provider:t,success:function(i){s.code=i.code;var a=getApp().globalData.PROVIDER[t];getApp().globalData.APPTYPE=a,e.request({url:o.requestURL+"/auth/mobile/token/social?grant_type=mobile&mobile="+a+"@"+i.code,method:"post",header:{Authorization:getApp().globalData.CLIENT,"TENANT-ID":getApp().globalData.TENANTID},success:function(t){200==t.statusCode&&(e.setStorageSync("Authorization","Bearer "+t.data.access_token),e.setStorageSync("refreshToken",t.data.refresh_token),e.setStorageSync("refreshTokenTime",parseInt((new Date).getTime()/1e3)),e.setStorageSync("userId",t.data.user_id),e.setStorageSync("userName",t.data.username),s.userId=t.data.user_id,null!=s.shareUserId&&s.toAddShareIntegral())}})},fail:function(t){console.log("用户拒绝了授权: "+JSON.stringify(t)),e.hideLoading()}})},getSysShareQrcode:function(e,t){var s=this,o=getApp().globalData.wxAppId,i={appId:o,appname:"mini",type:"MINI",userId:this.userId,goodsId:this.goodsId,page:"pages/goods/goods",scene:"u="+this.userId+"&gid="+this.goodsId,is_hyaline:!0};(0,a.getShareQrcode)(i,o).then((function(o){0==o.data.code&&(s.shareQrCode=o.data.data,s.createCanvasImageEvn(e,t))}))},createCanvasImageEvn:function(e,t){var s=this;this.shareQrCode,this.swiperList[this.currentSwiper].value,this.goodsData.name,null!=this.goodsData.discountPrice?this.goodsData.discountPrice:this.goodsData.price;null==e&&(e="小 U 推荐"),null==t&&(t=this.goodsData.coverImg),this.posterData={shopName:getApp().globalData.shopName,url:this.swiperList[this.currentSwiper].value,title:this.goodsData.name,nickName:e,avatarUrl:t,discountPrice:this.goodsData.discountPrice+"",orignPrice:this.goodsData.price+"",icon:"https://auu.oss-cn-hangzhou.aliyuncs.com/tgj.jpg",code:this.shareQrCode},s.deliveryFlag=!1,s.open(),console.log(this.posterData)},closeShareEvn:function(){this.deliveryFlag=!1},canvasCancel:function(e){this.canvasFlag=e},gotUserInfo:function(t){var s=t.detail.userInfo,o=s.avatarUrl,i=s.nickName,n={userId:this.userId,avatar:o,nickname:i};e.setStorageSync("avatar",o),e.setStorageSync("nickname",i),(0,a.updateUserInfo)(n).then((function(e){console.log(e)})),this.getSysShareQrcode(i,o)},h5gotUserInfo:function(){this.goodsData.coverImg;this.getSysShareQrcode()},toAddShareIntegral:function(){if(null==this.shareUserId||""==this.shareUserId)return!1;var t={formId:null==this.userId?0:this.userId,goodsId:this.goodsId,userId:this.shareUserId,type:"SHARE",appCpde:getApp().globalData.APPNAME};(0,a.increaseIntegral)(t).then((function(t){0==t.data.code&&t.data.msg&&e.showToast({title:"好友获得"+t.data.data+"积分",icon:"success"})}))},hideShare:function(){var e=this;this.shareClass="hide",setTimeout((function(){e.shareClass="none"}),150)},hideFab:function(){},keep:function(){this.isKeep=!this.isKeep},toCart:function(){e.switchTab({url:"../tabBar/cart/cart"})},toHome:function(){e.switchTab({url:"../tabBar/home/home"})},share:function(){this.shareClass="show"},open:function(){var e=this;this.$refs.popup.open(),this.canvasFlag=!1,setTimeout((function(){e.$refs.poster.OnCanvas()}),100)},cancel:function(e){this.$refs.popup.close(),this.canvasFlag=!0},change:function(e){console.log("是否打开:"+e.show)},saveCanvasImage:function(){this.$refs.poster.saveCanvasImage()}}};t.default=S}).call(this,s("543d")["default"])}},[["81aa","common/runtime","common/vendor"]]]);