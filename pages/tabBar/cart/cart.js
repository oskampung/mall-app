(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/tabBar/cart/cart"],{"046d":function(t,e,s){"use strict";s.r(e);var i=s("28aa"),o=s.n(i);for(var n in i)"default"!==n&&function(t){s.d(e,t,(function(){return i[t]}))}(n);e["default"]=o.a},"1a05":function(t,e,s){},"28aa":function(t,e,s){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var o=s("4a45"),n=(s("9ddd"),s("116b"));function r(t){if("undefined"===typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(t=a(t))){var e=0,s=function(){};return{s:s,n:function(){return e>=t.length?{done:!0}:{done:!1,value:t[e++]}},e:function(t){throw t},f:s}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o,n=!0,r=!1;return{s:function(){i=t[Symbol.iterator]()},n:function(){var t=i.next();return n=t.done,t},e:function(t){r=!0,o=t},f:function(){try{n||null==i.return||i.return()}finally{if(r)throw o}}}}function a(t,e){if(t){if("string"===typeof t)return u(t,e);var s=Object.prototype.toString.call(t).slice(8,-1);return"Object"===s&&t.constructor&&(s=t.constructor.name),"Map"===s||"Set"===s?Array.from(s):"Arguments"===s||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s)?u(t,e):void 0}}function u(t,e){(null==e||e>t.length)&&(e=t.length);for(var s=0,i=new Array(e);s<e;s++)i[s]=t[s];return i}var l=function(){Promise.all([s.e("common/vendor"),s.e("components/uni-icons/uni-icons")]).then(function(){return resolve(s("c930"))}.bind(null,s)).catch(s.oe)},d=function(){s.e("components/uni-nav-bar/uni-nav-bar").then(function(){return resolve(s("15b9"))}.bind(null,s)).catch(s.oe)},c={components:{uniIcons:l,uniNavBar:d},data:function(){return{provider:null,userId:null,baseUrl:o.requestURL,sumPrice:"0.00",headerPosition:"fixed",headerTop:null,statusTop:null,showHeader:!0,selectedList:[],isAllselected:!1,goodsList:[],theIndex:null,oldIndex:null,isStop:!1,page:{total:0,current:1,size:10,pages:10,orders:[]},loadingText:"正在加载...",likeList:[],likeMarginTop:"50%"}},onPageScroll:function(t){this.headerPosition=t.scrollTop>=0?"fixed":"absolute",this.headerTop=t.scrollTop>=0?null:0,this.statusTop=t.scrollTop>=0?null:-this.statusHeight+"px"},onPullDownRefresh:function(){setTimeout((function(){t.stopPullDownRefresh()}),1e3),this.loadCartGoodsList()},onShow:function(){this.userId=t.getStorageSync("userId"),this.loadCartGoodsList(),this.countMargin()},onLoad:function(){var e=this,s=this.provider;null!=s&&""!=s||t.getProvider({service:"oauth",success:function(t){e.provider=t.provider[0]}}),this.userId=t.getStorageSync("userId"),this.loadGoodsList(),this.countMargin()},methods:{loadCartGoodsList:function(){var e=this;return t.getStorage({key:"cartGoodsList",success:function(t){e.goodsList=t.data,console.log(t.data)}}),!1},loadGoodsList:function(){var t=this,e={current:this.page.current,size:this.page.size,type:"1"};Object.assign(e,this.page),(0,n.getGoodsList)(e).then((function(e){if(0==e.data.code&&null!=e.data.data&&(t.page.currentPage=e.data.data.current,t.page.pages=e.data.data.pages,e.data.data.records.length>0)){var s,i=e.data.data.records,o=r(i);try{for(o.s();!(s=o.n()).done;){var n=s.value;t.likeList.push(n)}}catch(a){o.e(a)}finally{o.f()}}t.loadingText=""}))},joinGoods:function(t){for(var e=this.goodsList.length,s=!1,o=0;o<e;o++){var n=this.goodsList[o];if(n.id==t.id){this.goodsList[o].number++,s=!0;break}}s||this.goodsList[i].unshift(t)},touchStart:function(t,e){e.touches.length>1?this.isStop=!0:(this.oldIndex=this.theIndex,this.theIndex=null,this.initXY=[e.touches[0].pageX,e.touches[0].pageY])},touchMove:function(t,e){var s=this;if(e.touches.length>1)this.isStop=!0;else{var i=e.touches[0].pageX-this.initXY[0],o=e.touches[0].pageY-this.initXY[1];this.isStop||Math.abs(i)<5||(Math.abs(o)>Math.abs(i)?this.isStop=!0:i<0?(this.theIndex=t,this.isStop=!0):i>0&&null!=this.theIndex&&this.oldIndex==this.theIndex&&(this.oldIndex=t,this.theIndex=null,this.isStop=!0,setTimeout((function(){s.oldIndex=null}),150)))}},touchEnd:function(t,e){this.isStop=!1},toGoods:function(e){t.navigateTo({url:"../../goods/goods?gid="+e})},toConfirmation:function(){for(var e=[],s=this.goodsList.length,i=0;i<s;i++)this.goodsList[i].selected&&e.push(this.goodsList[i]);e.length<1?t.showToast({title:"请选择商品结算",icon:"none"}):t.setStorage({key:"buylist",data:e,success:function(){t.navigateTo({url:"../../order/confirmation"})}})},deleteGoods:function(e){for(var s=this.goodsList.length,i=0;i<s;i++)if(e==this.goodsList[i].id){this.goodsList.splice(i,1),t.setStorage({key:"cartGoodsList",data:this.goodsList,success:function(){t.showToast({title:"已移出购物车"})}});break}this.selectedList.splice(this.selectedList.indexOf(e),1),this.sum(),this.oldIndex=null,this.theIndex=null},deleteList:function(){this.selectedList.length;while(this.selectedList.length>0)this.deleteGoods(this.selectedList[0]);this.selectedList=[],this.isAllselected=this.selectedList.length==this.goodsList.length&&this.goodsList.length>0,this.sum(),this.countMargin()},selected:function(t){this.goodsList[t].selected=!this.goodsList[t].selected;var e=this.selectedList.indexOf(this.goodsList[t].id);e>-1?this.selectedList.splice(e,1):this.selectedList.push(this.goodsList[t].id),this.isAllselected=this.selectedList.length==this.goodsList.length,this.sum()},allSelect:function(){for(var t=this.goodsList.length,e=[],s=0;s<t;s++)this.goodsList[s].selected=!this.isAllselected,e.push(this.goodsList[s].id);this.selectedList=this.isAllselected?[]:e,this.isAllselected=!this.isAllselected&&0!=this.goodsList.length,this.sum()},sub:function(t){this.goodsList[t].number<=1||(this.goodsList[t].number--,this.sum())},add:function(t){this.goodsList[t].number++,this.sum()},sum:function(t,e){this.sumPrice=0;for(var s=this.goodsList.length,i=0;i<s;i++)this.goodsList[i].selected&&(this.sumPrice=t&&i==e?this.sumPrice+t.detail.value*this.goodsList[i].price:this.sumPrice+this.goodsList[i].number*this.goodsList[i].price);this.sumPrice=this.sumPrice.toFixed(2)},discard:function(){},countMargin:function(){var t=50-14*this.goodsList.length;t<1&&(t=0),this.likeMarginTop=t+"%"},gotoUserPage:function(){t.switchTab({url:"/pages/tabBar/user/user"})}}};e.default=c}).call(this,s("543d")["default"])},6461:function(t,e,s){"use strict";s.r(e);var i=s("8430"),o=s("046d");for(var n in o)"default"!==n&&function(t){s.d(e,t,(function(){return o[t]}))}(n);s("87b3");var r,a=s("f0c5"),u=Object(a["a"])(o["default"],i["b"],i["c"],!1,null,null,null,!1,i["a"],r);e["default"]=u.exports},8430:function(t,e,s){"use strict";var i={"uni-nav-bar":function(){return s.e("components/uni-nav-bar/uni-nav-bar").then(s.bind(null,"15b9"))}},o=function(){var t=this,e=t.$createElement;t._self._c},n=[];s.d(e,"b",(function(){return o})),s.d(e,"c",(function(){return n})),s.d(e,"a",(function(){return i}))},"87b3":function(t,e,s){"use strict";var i=s("1a05"),o=s.n(i);o.a},f930:function(t,e,s){"use strict";(function(t){s("1822");i(s("66fd"));var e=i(s("6461"));function i(t){return t&&t.__esModule?t:{default:t}}t(e.default)}).call(this,s("543d")["createPage"])}},[["f930","common/runtime","common/vendor"]]]);